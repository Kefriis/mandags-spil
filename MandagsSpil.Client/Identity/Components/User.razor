@page "/user"
@using System.Security.Claims
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject NavigationManager NavigationManager

<HeaderTitle Title="User" />
<PageTitle>User</PageTitle>

<MudContainer MaxWidth="MaxWidth.Small" Class="pt-4">
    <MudGrid>
        <MudItem xs="6">
            <MudText Typo="Typo.h6">User:</MudText>
        </MudItem>
        <MudItem xs="6">
            <MudText Typo="Typo.h6">@UserPrincipal?.Identity?.Name</MudText>
        </MudItem>
        <MudItem xs="12">
            <MudButton StartIcon="@Icons.Material.Filled.Logout" OnClick="NavigateLogout" Size="Size.Large"
                FullWidth="true" Variant="Variant.Outlined">Logout</MudButton>
        </MudItem>
    </MudGrid>

</MudContainer>


@code {
    private ClaimsPrincipal? UserPrincipal;

    protected override async Task OnInitializedAsync()
    {
        var authState = await AuthenticationStateProvider
        .GetAuthenticationStateAsync();
        UserPrincipal = authState.User;
    }

    private void NavigateLogout()
    {
        NavigationManager.NavigateTo("/logout?ReturnUrl=/");
    }
}